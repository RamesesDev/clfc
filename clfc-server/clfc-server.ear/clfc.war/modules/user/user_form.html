<script type="text/javascript">
	$put("userform",
		new function() {
			var svc = ProxyService.lookup( 'UserAdminService' );
			var userGroupSvc = ProxyService.lookup( 'UserGroupService' );
            var roleAdminSvc = ProxyService.lookup( 'RoleAdminService' );
                        
            this.typeList = [];
            this.roleList = [];
                       
            this.entity = {};
            this.mode = "create";
            
            this.save = function() {
                this.entity = svc.createNewUser(this.entity);
                $ctx("user").userListModel.refresh(true);                
                this.entity = {};
                alert('User record successfully saved.');
				return "_close";
            }
            
            this.editLogin = function() {
				return "edit-login";
            }
            
            this.editRole = function() {
                this.typeList = userGroupSvc.getOrgType();
                this.roleList = roleAdminSvc.getRoleName();
                return "edit-role";
            }
            
            this.showParent = function(){			
            	if(this.entity.type != null){					
					return userGroupSvc.getOrgName({"type":this.entity.type});
				}
				else {
					return [];
				}
			}
        },
		{
			"default":"modules/user/user_form_init.html",
		 	"edit-role":"modules/user/user_role_form.html",
		 	"edit-login":"modules/user/user_login_form.html"
		}
	);
</script>

<div controller="userform"></div>


