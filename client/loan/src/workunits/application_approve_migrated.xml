<workunit>
    <invokers>
        <invoker type="application:pending_action" caption="Approve Migrated Application"
                 action="approve" mnemonic="a" visibleWhen="#{entity.isMigrated == true}"
                 target="process"/>    
    </invokers>
    <code>
        <![CDATA[   
        import com.rameses.rcp.annotations.*;
        import com.rameses.rcp.common.*;
        import com.rameses.osiris2.client.*;
        
        class ApproveMigratedAppController {
            @Service("LoanApplicationService")
            def appSvc;

            @Binding
            def binding;

            //-- passed by the caller
            def application;
            def selectHandler;

            void approve() {
                if( MsgBox.confirm('You are about to approve this migrated application.\nPlease verify that all entries are correct. Proceed?') )
                {
                    def result = appSvc.approveMigratedApplication([objid: application.objid]);
                    application.putAll( result );
                    if( selectHandler ) selectHandler( application );
                    MsgBox.alert('Application already activated.');
                }
            }
        }
        ]]>
    </code>
</workunit>