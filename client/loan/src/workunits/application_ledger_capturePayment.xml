<workunit>
    <invokers>
        <invoker type="application:capturePayment" caption="Capture Payment" target="popup" permission="application.capturePayment"/>

        <invoker type="formActions" caption="Post Payment" mnemonic="p" action="postPayment" default="true"/>
        <invoker type="formActions" caption="Cancel"       mnemonic="c" action="_close" immediate="true"/>
    </invokers>
    <code>
        <![CDATA[
        import com.rameses.rcp.annotations.*;
        import com.rameses.rcp.common.*;
        import com.rameses.osiris2.client.*;
        import com.rameses.util.*;                
        
        public class LoanAppLedgerCapturePaymentController{
            @Service('LoanPaymentService')
            def svc;
            
            def appid;
            def entity = [:];
            def handler;
            
            def postPayment() {
                if( !MsgBox.confirm("Are you sure you want to post this payment?") ) return;
                entity.appid = appid;
                entity.mode = 'CAPTURE';
                svc.postPayment( entity );
                if( handler ) handler( entity );
                return '_close';
            }   
        }
        ]]>
    </code>
    <pages>
        <page template="loan.ui.ledger.LedgerCapturePaymentPage"/>
    </pages>
</workunit>