<workunit>
    <invokers>        
        <invoker type="collection:overPayment" caption="Over Payment Form" target="popup"/>         
        
        <invoker type="formActions" action="Ok"     caption="Ok and continue" mnemonic="o" tooltip="Ok and Continue"/>
        <invoker type="formActions" action="_close" caption="Cancel" mnemonic="c" tooltip="Cancel" immediate="true"/>
        
    </invokers>
    <code> 
        <![CDATA[
        import com.rameses.rcp.annotations.*;
        import com.rameses.rcp.common.*;
        import com.rameses.osiris2.client.*;
        
        class LoanRemittanceOverPaymentController{
            @Service("LoanRemittanceService")
            def remitSvc;
            
            @Service("LoanCollectionSheetService")
            def colSheetSvc;

            @Service( "LoanApplicationSearchService" )
            def searchSvc;
            
            def difference;
            def overSelectHandler;
            def overHandler={o->
                entity.routecode=o.code;
                entity.collector=o.collector;
                entity.routedescription=o.description;
                //entity.route = entity.routecode + " - " + entity.routedescription;
                entity.amount = difference;
                binding.refresh("entity.route");
            };
            
            def entity = [ date: OsirisContext.env.LOCALE_TIME ];
            
            def Ok(){
                if(MsgBox.confirm("Are you sure you want to post this \nshort payment remittance, proceed.?")){
                    return "_close";
               }
            }
        }    
        ]]>
    </code>
    <pages>
        <page template="loantreasury.remittance.field.LoanRemittance_ShortageOverPaymentPage"/>
    </pages>    
</workunit>